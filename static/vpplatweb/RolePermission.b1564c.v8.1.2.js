webpackJsonp([34],{1213:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(172),i=l(n),o=a(323),s=l(o),r=a(459),u=l(r),d=a(54),c=l(d),p=a(55),f=l(p),h=a(59),m=l(h),g=a(93),v=l(g),y=a(8),b=l(y),w=a(4),C=a(726),k=l(C),S=a(609),E=function(e){function t(e){(0,c["default"])(this,t);var a=(0,m["default"])(this,(t.__proto__||(0,u["default"])(t)).call(this,e));return a.getHeader=function(){var e=a;(0,w.vpAdd)("/{vpplat}/cfgrolegroup/getListHeader",{pageType:"rolegroupuser"}).then(function(t){var a=t.data;if(a&&(e.setState({loading:!1}),a.hasOwnProperty("grid"))){var l=[];a.grid.hasOwnProperty("fields")&&(a.grid.fields.map(function(e,t){var a=void 0,n=void 0,i=void 0,o=void 0;for(var s in e)"title"==s?a=e[s]:"field"==s&&(n=e[s]),"fixed"==s&&(o=e[s]),"width"==s&&(i=e[s]);a&&n&&("left"==o||"right"==o?l.push({title:a,dataIndex:n,key:n,width:i,fixed:o}):l.push({title:a,dataIndex:n,key:n,fixed:o}))}),e.setState({table_headers:l}))}})["catch"](function(e){})},a.getData=function(){var e=a,t={type:1,pageType:"rolegroupuser",idepartmentid:0,irolegroupid:a.props.groupid};t.curr=a.state.cur_page,t.limit=a.state.num_perpage,(0,w.vpAdd)("/{vpplat}/cfgrolegroup/getListData",{sparam:(0,s["default"])(t)}).then(function(t){var a=t.data.data,l=function(){return"共"+a.totalRows+"条"};e.setState({table_array:a.resultList,cur_page:a.currentPage,total_rows:a.totalRows,num_perpage:a.numPerPage,pagination:{total:a.totalRows,showTotal:l,pageSize:a.numPerPage,showSizeChanger:!0,showQuickJumper:!0}})})["catch"](function(e){"function"!=typeof e||e()})},a.tableChange=function(e,t,l){a.setState({cur_page:e.current||a.state.cur_page,num_perpage:e.pageSize||a.state.num_perpage},function(){a.getData()})},a.handleSelect=function(e,t,l){var n=a.state.selectedRowKeys,o=0;t?a.setState({selectedRowKeys:[].concat((0,i["default"])(n),[e.iid])}):(n.forEach(function(t,a){t===e.iid&&(o=a)}),a.setState({selectedRowKeys:[].concat((0,i["default"])(n.slice(0,o)),(0,i["default"])(n.slice(o+1)))}))},a.handleSelectAll=function(e,t,l){t=t.map(function(e){return e.iid}),a.setState({selectedRowKeys:t})},a.toolBarClick=function(e){var t=a.state.selectedRowKeys,l={delType:"delUser",userids:t.join(),irolegroupid:a.props.groupid};"add"==e?a.handleModal():"del"==e&&(t.length>0?(0,w.vpAdd)("/{vpplat}/cfgrolegroup/delete",{sparam:(0,s["default"])(l)}).then(function(e){e.data.success&&a.setState({selectedRowKeys:[]},a.getData)}):(0,w.VpAlertMsg)({message:"消息提示",description:"请至少选择一条数据！",type:"error",closeText:"关闭",showIcon:!0},5))},a.onRowClick=function(e){var t=a;(0,w.vpQuery)("/{vpplat}/vfrm/entity/getform",{entityid:2,iid:e.iid}).then(function(a){a&&a.hasOwnProperty("data")&&a.data.hasOwnProperty("form")&&a.data.form.hasOwnProperty("groups")&&t.setState({iid:e.iid,modaltitle:"用户>"+e.sname,increaseData:a.data.form,visible:!0})})["catch"](function(e){})},a.cancelChoosen=function(){a.setState({updateCharer:!1})},a.submitChoosen=function(e){var t=a,l="",n="";e.map(function(e,t){t>0&&(l+=",",n+=","),l+=e.sname,n+=e.iid});var i={userids:n,irolegroupid:a.props.groupid};(0,w.vpAdd)("/{vpplat}/cfgrolegroup/addUser",{sparam:(0,s["default"])(i)}).then(function(e){e.data.success&&t.setState({selectedRowKeys:[]},function(){t.getData(),t.cancelChoosen()})})},a.handleModal=function(){a.setState({updateCharer:!0})},a.handleCancel=function(){a.setState({visible:!1,increaseData:[]})},a.state={groupid:0,updateCharer:!1,visible:!1,increaseData:[],modaltitle:"",filters:[],table_headers:[],table_array:[],cur_page:1,num_perpage:10,selectedRowKeys:[],pagination:{}},a}return(0,v["default"])(t,e),(0,f["default"])(t,[{key:"componentWillMount",value:function(){this.getHeader(),this.getData()}},{key:"componentDidMount",value:function(){var e=this;setTimeout(function(){vp.computedHeight(e.state.table_array.length,".table-body-height",288)},1e3)}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.groupid!=this.state.groupid&&this.setState({groupid:e.groupid},function(){t.getData()})}},{key:"render",value:function(){var e=this,t=(this.state.selectedRowKeys,{type:"checkbox",onSelect:this.handleSelect,onSelectAll:this.handleSelectAll}),a={entityrole:!1};return b["default"].createElement("div",{className:"business-container pr full-height"},b["default"].createElement("div",{className:"full-height scroll-y"},b["default"].createElement("div",{className:"subAssembly b-b bg-white",style:this.props.style},b["default"].createElement(w.VpRow,{gutter:1},b["default"].createElement(w.VpCol,{className:"gutter-row text-right",span:30},b["default"].createElement(w.VpTooltip,{placement:"top",title:"新建"},b["default"].createElement(w.VpButton,{type:"primary",style:{margin:"0 3px"},shape:"circle",icon:"plus",onClick:function(){return e.toolBarClick("add")}})),b["default"].createElement(w.VpTooltip,{placement:"top",title:"删除"},b["default"].createElement(w.VpPopconfirm,{placement:"bottomLeft",title:"确认删除所选记录?",onConfirm:function(){return e.toolBarClick("del")},onCancel:this.cancel},b["default"].createElement(w.VpButton,{type:"ghost",style:{margin:"0 3px"},shape:"circle",icon:"cross"})))))),b["default"].createElement("div",{className:"business-wrapper full-height"},b["default"].createElement("div",{className:"p-sm bg-white"},b["default"].createElement(w.VpTable,{columns:this.state.table_headers,dataSource:this.state.table_array,onChange:this.tableChange,onRowClick:this.onRowClick,pagination:this.state.pagination,rowSelection:t,rowKey:function(e){return e.iid+e.num},resize:!0,className:"table-body-height"})))),b["default"].createElement(w.VpModal,{title:"添加用户",visible:this.state.updateCharer,width:"70%",height:"80%",footer:null,wrapClassName:"modal-no-footer",onCancel:function(){return e.cancelChoosen()}},this.state.updateCharer?b["default"].createElement(k["default"],{item:{irelationentityid:"2"},initValue:[],params:{custparam:{ionline:0}},onCancel:function(){return e.cancelChoosen()},onOk:function(t){return e.submitChoosen(t)}}):""),b["default"].createElement(w.VpModal,{title:this.state.modaltitle,visible:this.state.visible,width:"70%",height:"80%",footer:null,wrapClassName:"modal-no-footer",onCancel:function(){return e.handleCancel()}},this.state.visible?b["default"].createElement(S.VpDynamicForm,{className:"p-sm full-height scroll p-b-xxlg",ref:function(t){return e.dynamic=t},bindThis:this,formData:this.state.increaseData,params:a}):""))}}]),t}(y.Component);t["default"]=E=(0,w.VpFormCreate)(E)},1284:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(172),i=l(n),o=a(323),s=l(o),r=a(459),u=l(r),d=a(54),c=l(d),p=a(55),f=l(p),h=a(59),m=l(h),g=a(93),v=l(g),y=a(8),b=l(y),w=a(4),C=a(609),k=a(1285),S=l(k),E=a(1288),x=l(E),V=a(1292),_=l(V),R=a(1213),N=l(R);a(1293);var T=function(e){function t(e){(0,c["default"])(this,t);var a=(0,m["default"])(this,(t.__proto__||(0,u["default"])(t)).call(this,e));return a.systemRole=function(){var e=a;(0,w.vpQuery)("/{vpplat}/api/pur/point",{saccesskey:"system"}).then(function(t){var a=!0;t.data.system>0&&(a=!1),e.setState({disabled:a})})},a.getHeader=function(){var e=a;(0,w.vpAdd)("/{vpplat}/cfgrolegroup/getListHeader",{pageType:"rolegroup"}).then(function(t){var a=t.data;if(a&&(e.setState({loading:!1}),a.hasOwnProperty("grid"))){var l=[];a.grid.hasOwnProperty("fields")&&(a.grid.fields.map(function(e,t){var a=void 0,n=void 0,i=void 0,o=void 0;for(var s in e)"title"==s?a=e[s]:"field"==s&&(n=e[s]),"fixed"==s&&(o=e[s]),"width"==s&&(i=e[s]);a&&n&&("left"==o||"right"==o?l.push({title:a,dataIndex:n,key:n,width:i,fixed:o}):l.push({title:a,dataIndex:n,key:n,fixed:o}))}),e.setState({table_headers:l}))}})["catch"](function(e){})},a.getData=function(){var e=a,t={type:1,pageType:"rolegroup",idepartmentid:0};t.curr=a.state.cur_page,t.limit=a.state.num_perpage,(0,w.vpAdd)("/{vpplat}/cfgrolegroup/getListData",{sparam:(0,s["default"])(t)}).then(function(t){var a=t.data.data,l=!0;t.data.accesslevel>0&&(l=!1);var n=function(){return"共"+a.totalRows+"条"};e.setState({disabled:l,table_array:a.resultList,cur_page:a.currentPage,total_rows:a.totalRows,num_perpage:a.numPerPage,pagination:{total:a.totalRows,showTotal:n,pageSize:a.numPerPage,onShowSizeChange:e.onShowSizeChange,showSizeChanger:!0,showQuickJumper:!0}})})["catch"](function(e){"function"!=typeof e||e()})},a.handleSelect=function(e,t,l){var n=0;t?a.setState({selectedRowKeys:[].concat((0,i["default"])(a.state.selectedRowKeys),[e.iid])}):(a.state.selectedRowKeys.forEach(function(t,a){t===e.iid&&(n=a)}),a.setState({selectedRowKeys:[].concat((0,i["default"])(a.state.selectedRowKeys.slice(0,n)),(0,i["default"])(a.state.selectedRowKeys.slice(n+1)))}))},a.handleSelectAll=function(e,t,l){t=t.map(function(e){return e.iid}),a.setState({selectedRowKeys:t})},a.onSelectChange=function(e){a.setState({selectedRowKeys:e})},a.toolBarClick=function(e){var t=a,l=a.state.selectedRowKeys;if("add"==e)a.showRightBox();else if("del"==e)if(l.length>0){var n={delType:"delGroup",ids:l.join()};(0,w.vpAdd)("/{vpplat}/cfgrolegroup/delete",{sparam:(0,s["default"])(n)}).then(function(e){e.data.success&&t.setState({selectedRowKeys:[]},t.getData())})}else(0,w.VpAlertMsg)({message:"消息提示",description:"请至少选择一条数据！",type:"error",closeText:"关闭",showIcon:!0},5)},a.onRowClick=function(e){a.showRightBox(e)},a.closeRightBox=function(e){a.setState({showRightBox:!1},function(){a.getData()})},a.showRightBox=function(e){a.setState({showRightBox:!0,groupid:e?e.iid:"0",groupname:e?e.sname:"",iid:e?e.iid:"0",edit:!0})},a.tabsChange=function(e){a.setState({VpTabsValue:e,groupid:1*a.state.groupid,iid:1*a.state.groupid}),a.getData(),a.forceUpdate()},a.setGroupTabs=function(e){a.setState({iid:1*e.iid,groupid:1*e.iid,groupname:e.sname},a.getData)},a.loadRightWindow=function(){return a.state.groupid>0?b["default"].createElement(w.VpTabs,{activeKey:a.state.VpTabsValue,onChange:a.tabsChange,key:a.state.groupid},b["default"].createElement(w.VpTabPane,{tab:"基本信息",key:"0"},b["default"].createElement(_["default"],{groupid:a.state.groupid,edit:a.state.edit,setGroupTabs:a.setGroupTabs.bind(a),activeValue:a.state.VpTabsValue,closeRightBox:a.closeRightBox})),b["default"].createElement(w.VpTabPane,{tab:"功能授权",key:"1"},b["default"].createElement(S["default"],{groupid:a.state.groupid,edit:a.state.edit,activeValue:a.state.VpTabsValue,closeRightBox:a.closeRightBox})),b["default"].createElement(w.VpTabPane,{tab:"数据权限",key:"2"},b["default"].createElement(x["default"],{groupid:a.state.groupid,edit:a.state.edit,activeValue:a.state.VpTabsValue,closeRightBox:a.closeRightBox})),b["default"].createElement(w.VpTabPane,{tab:"用户列表",key:"3"},b["default"].createElement(N["default"],{disabled:a.state.disabled,groupid:a.state.groupid}))):b["default"].createElement(w.VpTabs,{activeKey:a.state.VpTabsValue,onChange:a.tabsChange},b["default"].createElement(w.VpTabPane,{tab:"基本信息",key:"0"},b["default"].createElement(_["default"],{groupid:a.state.groupid,iid:a.state.iid,setGroupTabs:a.setGroupTabs.bind(a),activeValue:a.state.VpTabsValue,closeRightBox:a.closeRightBox})))},a.closeModal=function(){a.setState({showRightBox:!1})},a.state={groupid:a.props.groupid?a.props.groupid:"0",groupname:"",visible:!1,filters:[],table_headers:[],table_array:[],cur_page:1,num_perpage:10,pagination:{},showRightBox:!1,disabled:!0,VpTabsValue:"0",iid:"",edit:!1,selectedRowKeys:{}},a.handleSelect=a.handleSelect.bind(a),a.handleSelectAll=a.handleSelectAll.bind(a),a.onSelectChange=a.onSelectChange.bind(a),a.tableChange=a.tableChange.bind(a),a}return(0,v["default"])(t,e),(0,f["default"])(t,[{key:"componentDidMount",value:function(){var e=this;this.getHeader(),this.getData(),setTimeout(function(){vp.computedHeight(e.state.table_array.length,".tablelist")},500),this.systemRole()}},{key:"tableChange",value:function(e,t,a){var l=this;this.setState({cur_page:e.current||this.state.cur_page,num_perpage:e.pageSize||this.state.num_perpage},function(){l.getData()})}},{key:"onShowSizeChange",value:function(e){}},{key:"render",value:function(){var e=this,t=(this.state.selectedRowKeys,{type:"checkbox",onSelect:this.handleSelect,onSelectAll:this.handleSelectAll}),a={title:0==this.state.groupid?"新建角色":this.state.groupname,className:""};return b["default"].createElement("div",{className:"business-container pr full-height"},b["default"].createElement("div",{className:"subAssembly b-b bg-white",style:this.props.style},b["default"].createElement(w.VpRow,{gutter:1},b["default"].createElement(w.VpCol,{className:"gutter-row text-right",span:30},this.state.disabled?null:b["default"].createElement(w.VpTooltip,{placement:"top",title:"新建"},b["default"].createElement(w.VpButton,{type:"primary",style:{margin:"0 3px"},shape:"circle",icon:"plus",onClick:function(){return e.toolBarClick("add")},disabled:this.state.disabled})),b["default"].createElement(w.VpTooltip,{placement:"top",title:"删除"},b["default"].createElement(w.VpPopconfirm,{placement:"bottomLeft",title:"确认删除所选记录?",onConfirm:function(){return e.toolBarClick("del")},onCancel:this.cancel},b["default"].createElement(w.VpButton,{type:"ghost",style:{margin:"0 3px"},shape:"circle",icon:"cross",disabled:this.state.disabled})))))),b["default"].createElement("div",{className:"business-wrapper full-height p-t-sm"},b["default"].createElement("div",{className:"p-sm bg-white full-height scroll-y"},b["default"].createElement(w.VpTable,{columns:this.state.table_headers,dataSource:this.state.table_array,onChange:this.tableChange,onRowClick:this.onRowClick,pagination:this.state.pagination,rowSelection:t,rowKey:function(e){return e.iid},resize:!0,className:"tablelist"}))),b["default"].createElement(C.RightBox,{max:!1,maskClose:!0,onClose:this.closeModal,entity:a,className:"b-none rolepermission",show:this.state.showRightBox},this.state.showRightBox?this.loadRightWindow():null),b["default"].createElement(w.VpModal,{title:this.state.modaltitle,visible:this.state.visible,onOk:function(){return e.cancelModal()},onCancel:function(){return e.cancelModal()},width:"80%",height:"90%",maskClosable:!1,footer:null,wrapClassName:"modal-no-footer"}))}}]),t}(y.Component);t["default"]=T=(0,w.VpFormCreate)(T)},1285:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(323),i=l(n),o=a(459),s=l(o),r=a(54),u=l(r),d=a(55),c=l(d),p=a(59),f=l(p),h=a(93),m=l(h),g=a(8),v=l(g),y=a(4);a(1286);var b=a(729);l(b);a(730);var w=function(e){function t(e){(0,u["default"])(this,t);var a=(0,f["default"])(this,(t.__proto__||(0,s["default"])(t)).call(this,e));return a.state={maxHeight:$(window).height()-210,groupid:a.props.groupid?a.props.groupid:"0",mockData:[],titles:[],disabled:!1,selectId:"",loading:!0,treeKeys:[],data:[],visible:!1,loadingList:!0},a}return(0,m["default"])(t,e),(0,c["default"])(t,[{key:"componentDidMount",value:function(){var e=this,t={view:{showIcon:this.showIconForTree,showLine:!0,fontCss:{color:"#666"}},check:{enable:!0,chkStyle:"checkbox"},callback:{onAsyncSuccess:function(){e.setState({loading:!1})}},async:{enable:!0,type:"get",autoParam:["iid","key"],url:vp.config.URL.localHost+"/"+vp.config.SETTING.vpplat+"/cfg/roleper/funtree?access_token="+vp.cookie.getToken()+"&iid="+this.state.groupid+"&ilevel="+(vp.config.vpplat!=undefined&&vp.config.vpplat.funTreeOpenLevel!=undefined?vp.config.vpplat.funTreeOpenLevel:3)},data:{simpleData:{enable:!0,idKey:"iid",pIdKey:"pid",rootPId:0}}};$.fn.zTree.init($("#ztree"),t,null)}},{key:"showIconForTree",value:function(e,t){return!t.isParent}},{key:"handleSubmit",value:function(){var e=this,t=$.fn.zTree.getZTreeObj("ztree");this.setState({loading:!0});for(var a=t.getCheckedNodes(!0),l="",n=0;n<a.length;n++)a[n].children!=undefined&&0!=a[n].children.length||(l+=a[n].id+",");(0,y.vpAdd)("/{vpplat}/cfg/roleper/savefuntree",{sparam:(0,i["default"])({iid:this.props.groupid,pointiids:l})}).then(function(t){e.setState({loading:!1,groupid:1*t.data.iid}),(0,y.VpAlertMsg)({message:"消息提示",description:"数据保存成功",type:"success",onClose:e.onClose,closeText:"关闭",showIcon:!0},5),e.forceUpdate()})}},{key:"render",value:function(){var e=this;return v["default"].createElement("div",{className:"full-height RoleFunction"},v["default"].createElement(y.VpSpin,{spinning:this.state.loading,className:"layout-spin"},v["default"].createElement("div",{className:"layout-view p-b-xxlg"},v["default"].createElement("div",{className:"full-height scroll-y"},v["default"].createElement(y.VpForm,{horizontal:!0},v["default"].createElement("div",{className:"bg-white full-height"},v["default"].createElement(y.VpRow,{className:"full-height"},v["default"].createElement(y.VpCol,{sm:3,className:"text-right p-lr-sm"},v["default"].createElement("label",{className:"ant-form-item-required ant-form-item-label label body label"},"功能列表:")),v["default"].createElement(y.VpCol,{key:"transfer",sm:21,className:"full-height"},v["default"].createElement("div",{className:"p-sm",style:{maxHeight:this.state.maxHeight,overflow:"auto"}},v["default"].createElement("ul",{id:"ztree",className:"ztree",style:{padding:"0px"}}))))))),v["default"].createElement("div",{className:"footer-button-wrap ant-modal-footer"},v["default"].createElement(y.VpButton,{className:"vp-btn-br",key:"saveBat",type:"primary",onClick:function(){return e.handleSubmit()},disabled:this.state.disabled},"保存")))))}}]),t}(g.Component);t["default"]=w=(0,y.VpFormCreate)(w)},1286:function(e,t,a){var l=a(1287);"string"==typeof l&&(l=[[e.id,l,""]]);var n={hmr:!0};n.transform=void 0;a(465)(l,n);l.locals&&(e.exports=l.locals)},1287:function(e,t){},1288:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(323),i=l(n),o=a(459),s=l(o),r=a(54),u=l(r),d=a(55),c=l(d),p=a(59),f=l(p),h=a(93),m=l(h),g=a(8),v=l(g),y=a(4),b=a(609);a(1286),a(1289);var w=a(1291),C=l(w),k=function(e){function t(e){(0,u["default"])(this,t);var a=(0,f["default"])(this,(t.__proto__||(0,s["default"])(t)).call(this,e));return a.getDateTree=function(){a.setState({loading:!0}),(0,y.vpQuery)("/{vpplat}/cfg/roleper/datatree",{iid:a.state.groupid}).then(function(e){if(200===e.status){var t=a.state.checkAll,l=e.data.data,n=JSON.parse((0,i["default"])(l));l.length&&(l=l[0].children,l.map(function(e){if(/\\/.test((0,i["default"])(e.datavalue))?e.datavalue=JSON.parse(e.datavalue):e.datavalue=e.datavalue.replace("[","").replace("]","").split(","),e.datavalue.length<a.arrayLength)for(var l=0;l<a.arrayLength-e.datavalue.length;l++)e.datavalue.push("");e.datavalue.map(function(e,a){t[a]===undefined&&(t[a]=!0),e||(t[a]=!1)}),e.children&&e.children instanceof Array&&e.children.map(function(e){e.datavalue=e.datavalue.replace("[","").replace("]","").split(",")})})),a.setState({data:l,datas:n,checkAll:t,loading:!1})}})},a.handleSubmit=function(){var e=a,t=a.state.datas,l=JSON.parse((0,i["default"])(a.state.data));l.map(function(e){e.datavalue=(0,i["default"])(e.datavalue),e.children&&e.children.map(function(e){e.datavalue="["+e.datavalue+"]"})}),t[0].children=l,e.props.form.validateFields(function(l,n){var o={iid:e.state.groupid,treedata:t};0!=e.props.groupid&&(e.setState({loading:!0}),(0,y.vpAdd)("/{vpplat}/cfg/roleper/savedata",{sparam:(0,i["default"])(o)}).then(function(t){e.setState({loading:!1}),200===t.status&&((0,y.VpAlertMsg)({message:"消息提示",description:"数据保存成功",type:"success",onClose:a.onClose,closeText:"关闭",showIcon:!0},5),0==e.props.edit&&e.props.nextbox(1*e.props.activeValue+1+""))}))})},a.thSelect=function(e,t){var l=a.state.checkAll,n=a.addPermission(e,t);l[t]=!!e,a.setState({data:n,checkAll:l})},a.addPermission=function(e,t){var l=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;return l||(l=a.state.data),l.map(function(a){a.children&&a.children instanceof Array&&a.children.map(function(a){a.datavalue.splice(t,1,e||"")}),a.datavalue.splice(t,1,e||"")}),l},a.tdSelect=function(e,t){var l=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0,n=a.state,i=n.data,o=n.checkAll,s=t.children;"string"==typeof t.datavalue&&(t.datavalue=t.datavalue.replace("[","").replace("]","").split(",")),t.datavalue[l]?(t.datavalue[l]="",e="",o[l]=!1):(t.datavalue[l]=e,o=a.isCheckAll(i,o,l)),s&&(s=a.addPermission(e,l,s)),a.setState({data:i,checkAll:o})},a.isCheckAll=function(e,t,a){for(var l=JSON.parse((0,i["default"])(t)),n=0;n<e.length;n++){if(!e[n].datavalue[a])return l[a]=!1,l;l[a]=!0}return l},a.onChange1=function(e,t){return},a.toogleModal=function(e,t,l){var n=a;if(e){var i=l.key.split("-");a.setState({showRightBox:e,showRightTitle:l.name+(0==t?"：负责人":"：创建人"),rentityid:i[5],rroletype:t},function(){""!=a.state.rentityid&&(0,y.vpQuery)("/{vpplat}/cfg/roleper/getrole",{entityid:a.state.rentityid,roletype:a.state.rroletype}).then(function(e){n.setState({iroleid:e.data.iroleid})})["catch"](function(e){"function"!=typeof e||e()})})}else a.setState({showRightBox:e})},a.state={groupid:a.props.groupid?a.props.groupid:"0",mockData:[],targetKeys:[],titles:[],operations:[],isOnly:!1,updateCharer:!1,disabled:!1,treeData:[],selectId:"",visible:!1,loading:!1,data:[],datas:[],checkAll:[],showRightBox:!1,showRightTitle:"",rentityid:0,rroletype:0,iroleid:0},a.arrayLength=10,a}return(0,m["default"])(t,e),(0,c["default"])(t,[{key:"componentDidMount",value:function(){this.getDateTree()}},{key:"componentWillReceiveProps",value:function(e){"2"===e.activeValue?this.getDateTree():this.setState({showRightBox:!1})}},{key:"handleSubmit1",value:function(){this.props.nextbox(1*this.props.activeValue-1+"")}},{key:"render",value:function(){var e=this,t=this.state,a=t.checkAll,l=t.data,n=t.showRightBox,i=(t.loading,[null,{title:"创建者",checkbox:[]},{title:"负责人",checkbox:[{value:a[1]?["10"]:[],options:[{label:"",value:"10"}],onChange:function(t){return e.thSelect(t[0],1)}}]},{title:"成员",checkbox:[{value:a[4]?["1"]:[],options:[{label:"",value:"1"}],onChange:function(t){return e.thSelect(t[0],4)}},{value:a[5]?["11"]:[],options:[{label:"",value:"11"}],onChange:function(t){return e.thSelect(t[0],5)}}]},{title:"科室",checkbox:[{value:a[6]?["2"]:[],options:[{label:"",value:"2"}],onChange:function(t){return e.thSelect(t[0],6)}},{value:a[7]?["21"]:[],options:[{label:"",value:"21"}],onChange:function(t){return e.thSelect(t[0],7)}}]},{title:"全部",checkbox:[{value:a[8]?["3"]:[],options:[{label:"",value:"3"}],onChange:function(t){return e.thSelect(t[0],8)}},{value:a[9]?["31"]:[],options:[{label:"",value:"31"}],onChange:function(t){return e.thSelect(t[0],9)}}]}]),o=[{title:"",dataIndex:"name",key:"name",width:100},{title:"",key:"establish",render:function(t,a,l){if(a.datavalue)return v["default"].createElement("div",{className:"check-box"},v["default"].createElement(y.VpTooltip,{placement:"top",title:"设置创建人权限"},v["default"].createElement(y.VpIcon,{type:"setting",onClick:function(){return e.toogleModal(!0,4,a)}})))}},{title:"",key:"operation",render:function(t,a,l){if(a.datavalue)return v["default"].createElement("div",{className:"check-box"},v["default"].createElement(y.VpCheckbox,{value:[a.datavalue[1]],options:[{label:"",value:"10"}],onChange:function(){return e.tdSelect("10",a,1)}}),v["default"].createElement(y.VpTooltip,{placement:"top",title:"设置负责人权限"},v["default"].createElement(y.VpIcon,{type:"setting",onClick:function(){return e.toogleModal(!0,0,a)}})))}},{title:"",key:"cy",render:function(t,a,l){if(a.datavalue)return v["default"].createElement("div",{className:"check-box"},v["default"].createElement(y.VpCheckbox,{value:[a.datavalue[4]],options:[{label:"查看",value:"1"}],onChange:function(){return e.tdSelect("1",a,4)}}),v["default"].createElement(y.VpCheckbox,{value:[a.datavalue[5]],options:[{label:"编辑",value:"11"}],onChange:function(){return e.tdSelect("11",a,5)}}))}},{title:"",key:"bm",render:function(t,a,l){if(a.datavalue)return v["default"].createElement("div",{className:"check-box"},v["default"].createElement(y.VpCheckbox,{value:[a.datavalue[6]],options:[{label:"查看",value:"2"}],onChange:function(){return e.tdSelect("2",a,6)}}),v["default"].createElement(y.VpCheckbox,{value:[a.datavalue[7]],options:[{label:"编辑",value:"21"}],onChange:function(){return e.tdSelect("21",a,7)}}))}},{title:"",key:"qb",render:function(t,a,l){if(a.datavalue)return v["default"].createElement("div",{className:"check-box"},v["default"].createElement(y.VpCheckbox,{value:[a.datavalue[8]],options:[{label:"查看",value:"3"}],onChange:function(){return e.tdSelect("3",a,8)}}),v["default"].createElement(y.VpCheckbox,{value:[a.datavalue[9]],options:[{label:"编辑",value:"31"}],onChange:function(){return e.tdSelect("31",a,9)}}))}}];return v["default"].createElement("div",{className:"full-height RolePermissionForm"},v["default"].createElement(y.VpSpin,{spinning:this.state.loading,className:"layout-spin"},v["default"].createElement("div",{className:"layout-view p-b-xxlg"},v["default"].createElement("div",{className:"full-height scroll-y"},v["default"].createElement(y.VpForm,{horizontal:!0},v["default"].createElement("div",{className:"select-view"},v["default"].createElement("table",null,v["default"].createElement("tbody",null,v["default"].createElement("tr",null,i.map(function(e,t){return e?v["default"].createElement("td",{key:t},v["default"].createElement("div",{className:"th-select",key:t},v["default"].createElement("p",null,e.title),v["default"].createElement("div",{className:"allEletion"},e.checkbox&&e.checkbox.map(function(e,t){return v["default"].createElement(y.VpCheckbox,{key:"c_"+t,value:e.value,options:e.options,onChange:e.onChange})})))):v["default"].createElement("td",{key:t})}))))),v["default"].createElement(y.VpTable,{showHeader:!1,ref:function(t){return e.tableRef=t},pagination:!1,columns:o,dataSource:l,className:"modify-table"}))),v["default"].createElement("div",{className:"footer-button-wrap ant-modal-footer"},v["default"].createElement(y.VpButton,{className:"vp-btn-br",key:"saveBat",type:"primary",onClick:function(){return e.handleSubmit()},disabled:this.state.disabled},"保存")))),v["default"].createElement(b.RightBox,{max:!1,maskClose:!0,onClose:function(){return e.toogleModal(!1)},className:"small-lv",show:n},n?v["default"].createElement(y.VpTabs,{defaultActiveKey:"0",onChange:this.tabsChange},v["default"].createElement(y.VpTabPane,{tab:this.state.showRightTitle,key:"0"},v["default"].createElement(C["default"],{groupid:this.state.groupid,rentityid:this.state.rentityid,rroletype:this.state.rroletype,iroleid:this.state.iroleid,closeRightBox:this.closeRightBox}))):null))}}]),t}(g.Component);t["default"]=k=(0,y.VpFormCreate)(k)},1289:function(e,t,a){var l=a(1290);"string"==typeof l&&(l=[[e.id,l,""]]);var n={hmr:!0};n.transform=void 0;a(465)(l,n);l.locals&&(e.exports=l.locals)},1290:function(e,t){},1291:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(459),i=l(n),o=a(54),s=l(o),r=a(55),u=l(r),d=a(59),c=l(d),p=a(93),f=l(p),h=a(8),m=l(h),g=a(4);a(1286);var v=function(e){function t(e){(0,s["default"])(this,t);var a=(0,c["default"])(this,(t.__proto__||(0,i["default"])(t)).call(this,e));return a.iframeLoad=function(){},a.state={datas:[],checkAll:[],data:[],loading:!1},a.iframeDOM=null,a}return(0,f["default"])(t,e),(0,u["default"])(t,[{key:"componentWillReceiveProps",value:function(e){e.iroleid!=this.state.iroleid&&this.setState({groupid:e.groupid,rentityid:e.rentityid,rroletype:e.rroletype,iroleid:e.iroleid})}},{key:"componentWillUnmount",value:function(){this.iframeDOM&&(this.iframeDOM.onload=null)}},{key:"handleSubmit",value:function(){$(".roleframe")[0].contentWindow.saveForm(function(e){})}},{key:"render",value:function(){var e=this,t=this.state,a=t.groupid,l=t.loading,n=t.iroleid,i=t.rentityid;return a?m["default"].createElement("div",{className:"full-height scroll"},m["default"].createElement("div",{className:"full-height p-b-xxlg"},m["default"].createElement("div",{className:"full-height"},m["default"].createElement(g.VpSpin,{spinning:l,className:"full-height roleinfo"},m["default"].createElement(g.VpIframe,{className:"full-height roleframe",url:vp.config.SETTING.vpui+"/vpweb/vfm/ent/entity_roleform.html?from=react&roleid="+n+"&sysentityid="+i+"&entityid="+i+"&iid="+n})))),m["default"].createElement("div",{className:"footer-button-wrap ant-modal-footer"},m["default"].createElement(g.VpButton,{className:"vp-btn-br",key:"saveBat",type:"primary",onClick:function(){return e.handleSubmit()},disabled:this.state.disabled},"保存"))):m["default"].createElement("div",{className:"spin-view"},m["default"].createElement(g.VpSpin,{spinning:!0}))}}]),t}(h.Component);t["default"]=v=(0,g.VpFormCreate)(v)},1292:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(14),i=l(n),o=a(323),s=l(o),r=a(459),u=l(r),d=a(54),c=l(d),p=a(55),f=l(p),h=a(59),m=l(h),g=a(93),v=l(g),y=a(8),b=l(y),w=a(4);a(1286);var C=function(e){function t(e){(0,c["default"])(this,t);var a=(0,m["default"])(this,(t.__proto__||(0,u["default"])(t)).call(this,e));return a.loadForm=function(){var e=a.props.groupid;0!=e&&(a.setState({loading:!0}),(0,w.vpAdd)("/{vpplat}/cfgrolegroup/get",{sparam:(0,s["default"])({irolegroupid:e})}).then(function(e){if(e.data.success){var t=e.data.data;a.setState({loading:!1,sname:t.sname,sdescription:t.sdescription})}}))},a.state={groupid:e.groupid?e.groupid:"0",sname:"",sdescription:"",operations:[],disabled:!1,visible:!1,loading:!1},a}return(0,v["default"])(t,e),(0,f["default"])(t,[{key:"componentDidMount",value:function(){this.loadForm()}},{key:"handleSubmit",value:function(){var e=this,t=this.props.groupid,a=this,l=$("#sname").val(),n=$("#sdescription").val();""==l||l==undefined?(0,w.VpAlertMsg)({message:"消息提示",description:'"名称不能为空！',type:"error",onClose:this.onClose,closeText:"关闭",showIcon:!0},5):l.length>200?(0,w.VpAlertMsg)({message:"消息提示",description:"名称长度不能超过200个字符！",type:"error",closeText:"关闭",showIcon:!0},5):(a.setState({loading:!0}),(0,w.vpAdd)("/{vpplat}/cfg/roleper/saveBaseInfo",{sparam:(0,s["default"])({iid:t,sname:l,sdescription:n})}).then(function(t){1==t.data.success?(a.setState({loading:!1,iid:t.data.iid}),(0,w.VpAlertMsg)({message:"消息提示",description:"数据保存成功",type:"success",onClose:e.onClose,closeText:"关闭",showIcon:!0},5),a.props.setGroupTabs({iid:t.data.iid,sname:t.data.sname})):((0,w.VpAlertMsg)({message:"消息提示",description:t.data.msg,type:"error",onClose:e.onClose,closeText:"关闭",showIcon:!0},5),a.setState({loading:!1}))}))}},{key:"render",value:function(){var e=this,t={labelCol:{span:4},wrapperCol:{span:18}},a=this.state.loading,l=this.props.form.getFieldProps;return b["default"].createElement("div",{className:"full-height pr"},b["default"].createElement(w.VpSpin,{spinning:a,className:"layout-spin"},b["default"].createElement("div",{className:"layout-view p-b-xxlg"},b["default"].createElement("div",{className:"full-height scroll-y"},b["default"].createElement(w.VpForm,{horizontal:!0},b["default"].createElement("div",{className:"full-height"},b["default"].createElement(w.VpFInput,(0,i["default"])({label:"角色名称",type:"text"},t,l("sname",{initialValue:this.state.sname,rules:[{required:!0,message:"角色名称不能为空!"}]}))),b["default"].createElement(w.VpFInput,(0,i["default"])({label:"角色描述",type:"textarea",rows:5},t,l("sdescription",{initialValue:this.state.sdescription})))))),b["default"].createElement("div",{className:"footer-button-wrap ant-modal-footer"},b["default"].createElement(w.VpButton,{className:"vp-btn-br",key:"saveBat",type:"primary",onClick:function(){return e.handleSubmit()},disabled:this.state.disabled},"保存")))))}}]),t}(y.Component);t["default"]=C=(0,w.VpFormCreate)(C)},1293:function(e,t,a){var l=a(1294);"string"==typeof l&&(l=[[e.id,l,""]]);var n={hmr:!0};n.transform=void 0;a(465)(l,n);l.locals&&(e.exports=l.locals)},1294:function(e,t){}});